<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Employee Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #666;
            font-size: 1.1em;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: #ff9800;
            color: white;
        }
        
        .btn-warning:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }
        
        .data-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        
        .data-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            background: white;
            margin: 5px;
            border-radius: 5px;
        }
        
        .data-item:last-child {
            border-bottom: none;
        }
        
        .data-item:hover {
            background: #f0f0f0;
        }
        
        .employee-id {
            font-weight: bold;
            color: #667eea;
        }
        
        .timestamp {
            color: #666;
            font-size: 0.9em;
        }
        
        .comment-text {
            margin-top: 5px;
            padding: 8px;
            background: #f5f5f5;
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        .error {
            color: #f44336;
            padding: 10px;
            background: #ffebee;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .success {
            color: #4CAF50;
            padding: 10px;
            background: #e8f5e8;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-active {
            background: #e8f5e8;
            color: #4CAF50;
        }
        
        .status-inactive {
            background: #ffebee;
            color: #f44336;
        }
        
        .employee-actions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
  </head>
  <body>
    <div class="container">
        <div class="header">
            <h1>üë• Admin Dashboard - Employee Tracker</h1>
            <p>Qu·∫£n l√Ω nh√¢n vi√™n v√† theo d√µi ho·∫°t ƒë·ªông</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalEmployees">-</div>
                <div class="stat-label">T·ªïng nh√¢n vi√™n</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="activeEmployees">-</div>
                <div class="stat-label">Nh√¢n vi√™n ho·∫°t ƒë·ªông</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalActivities">-</div>
                <div class="stat-label">T·ªïng ho·∫°t ƒë·ªông</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalComments">-</div>
                <div class="stat-label">T·ªïng comment</div>
            </div>
        </div>
        
        <div class="content-grid">
            <div class="section">
                <h2>üë• Qu·∫£n l√Ω nh√¢n vi√™n</h2>
                <div class="controls">
                    <button class="btn btn-success" onclick="showAddEmployeeModal()">‚ûï Th√™m nh√¢n vi√™n</button>
                    <button class="btn btn-primary" onclick="loadEmployees()">üîÑ L√†m m·ªõi</button>
                    <button class="btn btn-warning" onclick="exportEmployees()">üì• Xu·∫•t danh s√°ch</button>
                </div>
                <div id="employeesList" class="data-list">
                    <div class="loading">ƒêang t·∫£i...</div>
                </div>
            </div>
            
            <div class="section">
                <h2>üìä Th·ªëng k√™ ho·∫°t ƒë·ªông</h2>
                <div class="controls">
                    <button class="btn btn-primary" onclick="loadEmployeeStats()">üîÑ L√†m m·ªõi</button>
                    <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è X√≥a t·∫•t c·∫£</button>
                </div>
                <div id="employeeStatsList" class="data-list">
                    <div class="loading">ƒêang t·∫£i...</div>
                </div>
            </div>
        </div>
        
        <div class="section" style="margin-top: 30px;">
            <h2>üí¨ Comment g·∫ßn ƒë√¢y</h2>
            <div class="controls">
                <button class="btn btn-primary" onclick="loadComments()">üîÑ L√†m m·ªõi</button>
                <button class="btn btn-danger" onclick="clearComments()">üóëÔ∏è X√≥a t·∫•t c·∫£</button>
            </div>
            <div id="commentsList" class="data-list">
                <div class="loading">ƒêang t·∫£i...</div>
            </div>
        </div>
    </div>
    
    <!-- Modal th√™m/s·ª≠a nh√¢n vi√™n -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">Th√™m nh√¢n vi√™n m·ªõi</h2>
            <form id="employeeForm">
                <div class="form-group">
                    <label for="modalEmployeeId">M√£ nh√¢n vi√™n *</label>
                    <input type="text" id="modalEmployeeId" placeholder="VD: NV001, EMP001" required>
                </div>
                <div class="form-group">
                    <label for="modalEmployeeName">T√™n nh√¢n vi√™n *</label>
                    <input type="text" id="modalEmployeeName" placeholder="H·ªç t√™n ƒë·∫ßy ƒë·ªß" required>
                </div>
                <div class="form-group">
                    <label for="modalPosition">Ch·ª©c v·ª•</label>
                    <input type="text" id="modalPosition" placeholder="VD: Nh√¢n vi√™n, Tr∆∞·ªüng nh√≥m">
                </div>
                <div class="form-group">
                    <label for="modalDepartment">Ph√≤ng ban</label>
                    <input type="text" id="modalDepartment" placeholder="VD: IT, Marketing, Sales">
                </div>
                <div class="form-group">
                    <label for="modalIsActive">Tr·∫°ng th√°i</label>
                    <select id="modalIsActive">
                        <option value="true">Ho·∫°t ƒë·ªông</option>
                        <option value="false">V√¥ hi·ªáu h√≥a</option>
                    </select>
                </div>
                <div class="controls">
                    <button type="submit" class="btn btn-success">üíæ L∆∞u</button>
                    <button type="button" class="btn btn-danger" onclick="closeEmployeeModal()">‚ùå H·ªßy</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal c·∫≠p nh·∫≠t m·∫≠t kh·∫©u -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <h2>üîê C·∫≠p nh·∫≠t m·∫≠t kh·∫©u nh√¢n vi√™n</h2>
            <form id="passwordForm">
                <div class="form-group">
                    <label for="passwordEmployeeId">M√£ nh√¢n vi√™n</label>
                    <input type="text" id="passwordEmployeeId" readonly>
                </div>
                <div class="form-group">
                    <label for="passwordEmployeeName">T√™n nh√¢n vi√™n</label>
                    <input type="text" id="passwordEmployeeName" readonly>
                </div>
                <div class="form-group">
                    <label for="newPassword">M·∫≠t kh·∫©u m·ªõi *</label>
                    <input type="password" id="newPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u *</label>
                    <input type="password" id="confirmPassword" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u" required>
                </div>
                <div class="controls">
                    <button type="submit" class="btn btn-success">üîê C·∫≠p nh·∫≠t m·∫≠t kh·∫©u</button>
                    <button type="button" class="btn btn-danger" onclick="closePasswordModal()">‚ùå H·ªßy</button>
                </div>
            </form>
        </div>
    </div>
    
    <script src="config.js"></script>
    <script>
        // Check admin authentication
        function checkAdminAuth() {
            const isLoggedIn = sessionStorage.getItem('admin_logged_in');
            const adminUsername = sessionStorage.getItem('admin_username');
            
            if (isLoggedIn !== 'true' || !adminUsername) {
                alert('üîê Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p trang Admin!');
                window.location.href = '/admin-login.html';
                return false;
            }
            
            // Show admin info
            const adminInfo = document.createElement('div');
            adminInfo.style.cssText = `
                position: fixed;
                top: 10px;
                right: 10px;
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 10px;
                border-radius: 5px;
                font-size: 12px;
                z-index: 1000;
            `;
            adminInfo.innerHTML = `
                üë§ Admin: ${adminUsername}
                <button onclick="logout()" style="margin-left: 10px; padding: 2px 8px; background: #f44336; border: none; color: white; border-radius: 3px; cursor: pointer;">üö™ Logout</button>
            `;
            document.body.appendChild(adminInfo);
            
            return true;
        }
        
        // Logout function
        function logout() {
            sessionStorage.removeItem('admin_logged_in');
            sessionStorage.removeItem('admin_username');
            alert('üëã ƒê√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng!');
            window.location.href = '/admin-login.html';
        }
        
        // Check auth on page load
        if (!checkAdminAuth()) {
            // Stop execution if not authenticated
            throw new Error('Unauthorized access');
        }
        
        const SERVER_URL = CONFIG.SERVER_URL;
        let currentEditingEmployee = null;
        
        // Load t·∫•t c·∫£ d·ªØ li·ªáu khi trang load
        document.addEventListener('DOMContentLoaded', () => {
            loadAllData();
        });
        
        async function loadAllData() {
            await Promise.all([
                loadEmployees(),
                loadEmployeeStats(),
                loadComments(),
                updateStats()
            ]);
        }
        
        async function loadEmployees() {
            try {
                const response = await fetch(`${SERVER_URL}/employees?admin_token=admin123`);
                const employees = await response.json();
                
                const employeesList = document.getElementById('employeesList');
                employeesList.innerHTML = '';
                
                if (employees.length === 0) {
                    employeesList.innerHTML = '<div class="loading">Ch∆∞a c√≥ nh√¢n vi√™n n√†o</div>';
                    return;
                }
                
                employees.forEach(employee => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    item.innerHTML = `
                        <div class="employee-id">üë§ ${employee.employeeName} (${employee.employeeId})</div>
                        <div>${employee.position} - ${employee.department}</div>
                        <div class="timestamp">T·∫°o: ${new Date(employee.createdAt).toLocaleString()}</div>
                        <span class="status-badge ${employee.isActive ? 'status-active' : 'status-inactive'}">
                            ${employee.isActive ? '‚úÖ Ho·∫°t ƒë·ªông' : '‚ùå V√¥ hi·ªáu'}
                        </span>
                        <div class="employee-actions">
                            <button class="btn btn-primary btn-small" onclick="editEmployee('${employee.employeeId}')">‚úèÔ∏è S·ª≠a</button>
                            <button class="btn btn-warning btn-small" onclick="updatePassword('${employee.employeeId}', '${employee.employeeName}')">üîê M·∫≠t kh·∫©u</button>
                            <button class="btn btn-danger btn-small" onclick="deleteEmployee('${employee.employeeId}')">üóëÔ∏è X√≥a</button>
                        </div>
                    `;
                    employeesList.appendChild(item);
                });
            } catch (error) {
                showError('L·ªói khi t·∫£i danh s√°ch nh√¢n vi√™n: ' + error.message);
            }
        }
        
        async function loadEmployeeStats() {
            try {
                const response = await fetch(`${SERVER_URL}/employees/stats?admin_token=admin123`);
                const stats = await response.json();
                
                const statsList = document.getElementById('employeeStatsList');
                statsList.innerHTML = '';
                
                if (stats.length === 0) {
                    statsList.innerHTML = '<div class="loading">Ch∆∞a c√≥ th·ªëng k√™ n√†o</div>';
                    return;
                }
                
                stats.forEach(stat => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    item.innerHTML = `
                        <div class="employee-id">üë§ ${stat.employeeName} (${stat.employeeId})</div>
                        <div>Ho·∫°t ƒë·ªông: ${stat.totalActivities} | Comment: ${stat.totalComments}</div>
                        <div class="timestamp">Ho·∫°t ƒë·ªông cu·ªëi: ${stat.lastActivity ? new Date(stat.lastActivity).toLocaleString() : 'N/A'}</div>
                    `;
                    statsList.appendChild(item);
                });
            } catch (error) {
                showError('L·ªói khi t·∫£i th·ªëng k√™ nh√¢n vi√™n: ' + error.message);
            }
        }
        
        async function loadComments() {
            try {
                const response = await fetch(`${SERVER_URL}/data?admin_token=admin123`);
                const data = await response.json();
                
                const commentsList = document.getElementById('commentsList');
                commentsList.innerHTML = '';
                
                if (data.comments.length === 0) {
                    commentsList.innerHTML = '<div class="loading">Ch∆∞a c√≥ comment n√†o</div>';
                    return;
                }
                
                data.comments.slice(-10).reverse().forEach(comment => {
                    const item = document.createElement('div');
                    item.className = 'data-item';
                    item.innerHTML = `
                        <div class="employee-id">üë§ ${comment.employeeName || 'N/A'} (${comment.employeeId})</div>
                        <div class="timestamp">Th·ªùi gian: ${new Date(comment.time).toLocaleString()}</div>
                        <div class="comment-text">"${comment.comment}"</div>
                    `;
                    commentsList.appendChild(item);
                });
            } catch (error) {
                showError('L·ªói khi t·∫£i comment: ' + error.message);
            }
        }
        
        async function updateStats() {
            try {
                const [employeesResponse, dataResponse] = await Promise.all([
                    fetch(`${SERVER_URL}/employees?admin_token=admin123`),
                    fetch(`${SERVER_URL}/data?admin_token=admin123`)
                ]);
                
                const employees = await employeesResponse.json();
                const data = await dataResponse.json();
                
                document.getElementById('totalEmployees').textContent = employees.length;
                document.getElementById('activeEmployees').textContent = employees.filter(emp => emp.isActive).length;
                document.getElementById('totalActivities').textContent = data.total.activities;
                document.getElementById('totalComments').textContent = data.total.comments;
            } catch (error) {
                console.error('L·ªói khi c·∫≠p nh·∫≠t th·ªëng k√™:', error);
            }
        }
        
        function showAddEmployeeModal() {
            currentEditingEmployee = null;
            document.getElementById('modalTitle').textContent = 'Th√™m nh√¢n vi√™n m·ªõi';
            document.getElementById('employeeForm').reset();
            document.getElementById('modalEmployeeId').disabled = false;
            document.getElementById('employeeModal').style.display = 'block';
        }
        
        function editEmployee(employeeId) {
            // T√¨m th√¥ng tin nh√¢n vi√™n v√† hi·ªÉn th·ªã modal
            fetch(`${SERVER_URL}/employees?admin_token=admin123`)
                .then(response => response.json())
                .then(employees => {
                    const employee = employees.find(emp => emp.employeeId === employeeId);
                    if (employee) {
                        currentEditingEmployee = employee;
                        document.getElementById('modalTitle').textContent = 'S·ª≠a th√¥ng tin nh√¢n vi√™n';
                        document.getElementById('modalEmployeeId').value = employee.employeeId;
                        document.getElementById('modalEmployeeId').disabled = true;
                        document.getElementById('modalEmployeeName').value = employee.employeeName;
                        document.getElementById('modalPosition').value = employee.position;
                        document.getElementById('modalDepartment').value = employee.department;
                        document.getElementById('modalIsActive').value = employee.isActive.toString();
                        document.getElementById('employeeModal').style.display = 'block';
                    }
                });
        }
        
        async function deleteEmployee(employeeId) {
            if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a nh√¢n vi√™n ${employeeId}?`)) return;
            
            try {
                const response = await fetch(`${SERVER_URL}/employees/${employeeId}?admin_token=admin123`, { method: 'DELETE' });
                if (response.ok) {
                    showSuccess('ƒê√£ x√≥a nh√¢n vi√™n th√†nh c√¥ng');
                    await loadAllData();
                } else {
                    showError('L·ªói khi x√≥a nh√¢n vi√™n');
                }
            } catch (error) {
                showError('L·ªói khi x√≥a nh√¢n vi√™n: ' + error.message);
            }
        }
        
        function closeEmployeeModal() {
            document.getElementById('employeeModal').style.display = 'none';
            currentEditingEmployee = null;
        }
        
        document.getElementById('employeeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                employeeId: document.getElementById('modalEmployeeId').value.trim(),
                employeeName: document.getElementById('modalEmployeeName').value.trim(),
                position: document.getElementById('modalPosition').value.trim(),
                department: document.getElementById('modalDepartment').value.trim(),
                isActive: document.getElementById('modalIsActive').value === 'true'
            };
            
            try {
                let response;
                if (currentEditingEmployee) {
                    // C·∫≠p nh·∫≠t nh√¢n vi√™n
                    response = await fetch(`${SERVER_URL}/employees/${formData.employeeId}?admin_token=admin123`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(formData)
                    });
                } else {
                    // Th√™m nh√¢n vi√™n m·ªõi
                    response = await fetch(`${SERVER_URL}/employees?admin_token=admin123`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(formData)
                    });
                }
                
                if (response.ok) {
                    showSuccess(currentEditingEmployee ? 'C·∫≠p nh·∫≠t nh√¢n vi√™n th√†nh c√¥ng' : 'Th√™m nh√¢n vi√™n th√†nh c√¥ng');
                    closeEmployeeModal();
                    await loadAllData();
                } else {
                    const errorData = await response.json();
                    showError(errorData.error || 'L·ªói khi l∆∞u nh√¢n vi√™n');
                }
            } catch (error) {
                showError('L·ªói khi l∆∞u nh√¢n vi√™n: ' + error.message);
            }
        });
        
        async function clearAllData() {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ d·ªØ li·ªáu?')) return;
            
            try {
                await fetch(`${SERVER_URL}/data?admin_token=admin123`, { method: 'DELETE' });
                showSuccess('ƒê√£ x√≥a t·∫•t c·∫£ d·ªØ li·ªáu');
                await loadAllData();
            } catch (error) {
                showError('L·ªói khi x√≥a d·ªØ li·ªáu: ' + error.message);
            }
        }
        
        async function clearComments() {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ comment?')) return;
            
            try {
                await fetch(`${SERVER_URL}/data?type=comments&admin_token=admin123`, { method: 'DELETE' });
                showSuccess('ƒê√£ x√≥a t·∫•t c·∫£ comment');
                await loadAllData();
            } catch (error) {
                showError('L·ªói khi x√≥a comment: ' + error.message);
            }
        }
        
        async function exportEmployees() {
            try {
                const response = await fetch(`${SERVER_URL}/employees?admin_token=admin123`);
                const employees = await response.json();
                
                const blob = new Blob([JSON.stringify(employees, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `employees-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                showSuccess('ƒê√£ xu·∫•t danh s√°ch nh√¢n vi√™n th√†nh c√¥ng');
            } catch (error) {
                showError('L·ªói khi xu·∫•t danh s√°ch: ' + error.message);
            }
        }
        
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            document.querySelector('.container').insertBefore(errorDiv, document.querySelector('.stats-grid'));
            
            setTimeout(() => errorDiv.remove(), 5000);
        }
        
        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success';
            successDiv.textContent = message;
            document.querySelector('.container').insertBefore(successDiv, document.querySelector('.stats-grid'));
            
            setTimeout(() => successDiv.remove(), 3000);
        }
        
        // Auto refresh m·ªói 30 gi√¢y
        setInterval(updateStats, 30000);
        
        // Password management functions
        function updatePassword(employeeId, employeeName) {
            document.getElementById('passwordEmployeeId').value = employeeId;
            document.getElementById('passwordEmployeeName').value = employeeName;
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('passwordModal').style.display = 'block';
        }
        
        function closePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
        }
        
        document.getElementById('passwordForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const employeeId = document.getElementById('passwordEmployeeId').value;
            
            if (newPassword !== confirmPassword) {
                showError('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp!');
                return;
            }
            
            if (newPassword.length < 6) {
                showError('M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±!');
                return;
            }
            
            try {
                const response = await fetch(`${SERVER_URL}/employees/${employeeId}/password?admin_token=admin123`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password: newPassword })
                });
                
                if (response.ok) {
                    showSuccess('C·∫≠p nh·∫≠t m·∫≠t kh·∫©u th√†nh c√¥ng!');
                    closePasswordModal();
                } else {
                    const errorData = await response.json();
                    showError(errorData.error || 'L·ªói khi c·∫≠p nh·∫≠t m·∫≠t kh·∫©u');
                }
            } catch (error) {
                showError('L·ªói khi c·∫≠p nh·∫≠t m·∫≠t kh·∫©u: ' + error.message);
            }
        });
    </script>
  </body>
</html>